<?xml version="1.0" encoding="ISO-8859-1"?>
<!--
  ~ Copyright (c) 2005-2006 jME Physics 2
  ~ All rights reserved.
  ~
  ~ Redistribution and use in source and binary forms, with or without
  ~ modification, are permitted provided that the following conditions are
  ~ met:
  ~
  ~  * Redistributions of source code must retain the above copyright
  ~    notice, this list of conditions and the following disclaimer.
  ~
  ~  * Redistributions in binary form must reproduce the above copyright
  ~    notice, this list of conditions and the following disclaimer in the
  ~    documentation and/or other materials provided with the distribution.
  ~
  ~  * Neither the name of 'jME Physics 2' nor the names of its contributors
  ~    may be used to endorse or promote products derived from this software
  ~    without specific prior written permission.
  ~
  ~ THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
  ~ "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED
  ~ TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  ~ PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR
  ~ CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  ~ EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  ~ PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  ~ PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  ~ LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  ~ NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  ~ SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
  -->

<project name="module_physics" default="compile.module.physics" basedir="..">
    <property name="module.physics.basedir" location="."/>


    <property name="compiler.args.physics" value="${compiler.args}"/>

    <property name="physics.output.dir" value="${module.physics.basedir}/classes"/>
    <property name="physics.testoutput.dir" value="${module.physics.basedir}/classes"/>
    <property name="physics.release.dir" value="${module.physics.basedir}/release"/>
    <property name="physics.javadoc.dir" value="${physics.release.dir}/api"/>

    <path id="physics.module.bootclasspath">
        <!-- Paths to be included in compilation bootclasspath -->
    </path>

    <path id="physics.module.classpath">
        <path refid="library.junit.classpath"/>
        <pathelement location="${jme.output.dir}"/>
        <pathelement location="${module.physics.basedir}/../jME/lib/jogg-0.0.5.jar"/>
        <pathelement location="${module.physics.basedir}/../jME/lib/lwjgl.jar"/>
        <pathelement location="${module.physics.basedir}/../jME/lib/jorbis-0.0.12.jar"/>
        <pathelement location="${module.physics.basedir}/../jME/lib/lwjgl_fmod3.jar"/>
    </path>


    <patternset id="excluded.from.module.physics">
        <patternset refid="ignored.files"/>
    </patternset>

    <patternset id="excluded.from.compilation.physics">
        <patternset refid="excluded.from.module.physics"/>
    </patternset>

    <path id="physics.module.sourcepath">
        <dirset dir="${module.physics.basedir}">
            <include name="src"/>
        </dirset>
    </path>

    <path id="physics.module.test.sourcepath">
        <dirset dir="${module.physics.basedir}">
            <include name="test"/>
            <include name="test-interactive"/>
        </dirset>
    </path>


    <target name="compile.module.physics" depends="compile.module.physics.production,compile.module.physics.tests"
            description="Compile module physics"/>

    <target name="compile.module.physics.production"
            description="Compile module physics; production classes"> <!--depends="compile.module.jme"-->
        <mkdir dir="${physics.output.dir}"/>
        <javac destdir="${physics.output.dir}" debug="${compiler.debug}" nowarn="${compiler.generate.no.warnings}"
               memoryMaximumSize="${compiler.max.memory}" fork="true">
            <compilerarg line="${compiler.args.physics}"/>
            <bootclasspath refid="physics.module.bootclasspath"/>
            <classpath refid="physics.module.classpath"/>
            <src refid="physics.module.sourcepath"/>
        </javac>

        <copy todir="${physics.output.dir}">
            <fileset dir="${module.physics.basedir}/src">
                <patternset refid="compiler.resources"/>
                <type type="file"/>
            </fileset>
        </copy>
    </target>

    <target name="compile.module.physics.tests" depends="compile.module.physics.production"
            description="compile module physics; test classes" unless="skip.tests"> <!--depends="compile.module.jme"-->
        <mkdir dir="${physics.testoutput.dir}"/>
        <javac destdir="${physics.testoutput.dir}" debug="${compiler.debug}" nowarn="${compiler.generate.no.warnings}"
               memoryMaximumSize="${compiler.max.memory}" fork="true">
            <compilerarg line="${compiler.args.physics}"/>
            <classpath refid="physics.module.classpath"/>
            <classpath location="${physics.output.dir}"/>
            <src refid="physics.module.test.sourcepath"/>
        </javac>

        <copy todir="${physics.testoutput.dir}">
            <fileset dir="${module.physics.basedir}/test">
                <patternset refid="compiler.resources"/>
                <type type="file"/>
            </fileset>
            <fileset dir="${module.physics.basedir}/test-interactive">
                <patternset refid="compiler.resources"/>
                <type type="file"/>
            </fileset>
        </copy>
    </target>

    <target name="release.module.physics" depends="compile.module.physics.production, javadoc.module.physics">
        <mkdir dir="${physics.release.dir}"/>
        <jar jarfile="${physics.release.dir}/jme-physics.jar" basedir="${physics.output.dir}" update="no"
             compress="true"
             includes="**">
            <manifest>
                <attribute name="Implementation-Title" value="${name}"/>
                <attribute name="Implementation-Vendor" value="jME Physics development team"/>
                <attribute name="Version" value="2.0.beta1"/>
                <attribute name="Class-Path" value="jme.jar jmetest.jar jmetest-data.jar lib/lwjgl.jar lib/jinput.jar jme-awt.jar"/>
                <attribute name="Main-Class" value="com.jmetest.physics.TestChooser"/>
            </manifest>
        </jar>
        <zip zipfile="${physics.release.dir}/jme-physics-src.zip">
            <zipfileset dir=".">
                <include name="**/*.java"/>
            </zipfileset>
        </zip>
        <zip zipfile="${physics.release.dir}/jme-physics-doc.zip">
            <zipfileset dir="${physics.javadoc.dir}">
                <include name="**"/>
            </zipfileset>
        </zip>
    </target>

    <target name="javadoc.module.physics">
        <javadoc destdir="${physics.javadoc.dir}" windowtitle="${name} API" use="true"
                 doctitle="${name}" classpathref="physics.module.classpath" source="1.5" failonerror="true">
            <packageset dir="${module.physics.basedir}/src" defaultexcludes="yes">
                <include name="**" />
            </packageset>
        </javadoc>
    </target>

    <target name="clean.module.physics" description="cleanup module">
        <delete dir="${physics.output.dir}"/>
        <delete dir="${physics.testoutput.dir}"/>
    </target>
</project>